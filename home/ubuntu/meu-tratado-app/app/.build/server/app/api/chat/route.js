"use strict";(()=>{var e={};e.id=744,e.ids=[744],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},677:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>O,patchFetch:()=>P,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>v,staticGenerationAsyncStorage:()=>h});var o={};t.r(o),t.d(o,{POST:()=>f,dynamic:()=>l});var n=t(921),a=t(7380),i=t(4185),s=t(3878);class u{log(e,r,t){let o={timestamp:new Date().toISOString(),level:e,message:r,...t&&{meta:t}};switch(e){case"error":console.error(JSON.stringify(o,null,2));break;case"warn":console.warn(JSON.stringify(o,null,2));break;case"info":console.info(JSON.stringify(o,null,2));break;case"debug":console.debug(JSON.stringify(o,null,2))}}info(e,r){this.log("info",e,r)}error(e,r){this.log("error",e,r)}warn(e,r){this.log("warn",e,r)}debug(e,r){this.log("debug",e,r)}}let c=new u;!function(){var e=Error("Cannot find module 'openai'");throw e.code="MODULE_NOT_FOUND",e}();let d=Object(function(){var e=Error("Cannot find module 'openai'");throw e.code="MODULE_NOT_FOUND",e}())({apiKey:process.env.OPENAI_API_KEY});async function p(e){try{c.info("Making OpenAI API request",{prompt:e});let r=await d.chat.completions.create({model:"gpt-3.5-turbo",messages:[{role:"user",content:e}]});return c.info("OpenAI API request successful"),r}catch(e){if(c.error("OpenAI API request failed",{error:e.message,code:e.code,type:e.type}),"invalid_api_key"===e.code)throw Error("Chave de API inv\xe1lida. Por favor, verifique suas configura\xe7\xf5es.");if("rate_limit_exceeded"===e.code)throw Error("Limite de requisi\xe7\xf5es excedido. Tente novamente mais tarde.");throw Error("Falha na comunica\xe7\xe3o com o servidor OpenAI. Por favor, tente novamente.")}}let l="force-dynamic";async function f(e){try{let r=process.env.OPENAI_API_KEY;if(!r||!function(e){let r=/^sk-[A-Za-z0-9]{48}$/.test(e);return c.info("API key validation result",{isValid:r}),r}(r))return c.error("Invalid API key configuration"),s.NextResponse.json({error:"Configura\xe7\xe3o inv\xe1lida da chave de API"},{status:401});let{prompt:t}=await e.json();if(!t)return c.warn("Missing prompt in request"),s.NextResponse.json({error:"Prompt \xe9 obrigat\xf3rio"},{status:400});let o=await p(t);return s.NextResponse.json(o)}catch(e){return c.error("Chat endpoint error",{error:e.message}),s.NextResponse.json({error:e.message||"Erro interno do servidor"},{status:e.status||500})}}let m=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/chat/route",pathname:"/api/chat",filename:"route",bundlePath:"app/api/chat/route"},resolvedPagePath:"/home/ubuntu/meu-tratado-app/app/app/api/chat/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:g,staticGenerationAsyncStorage:h,serverHooks:v}=m,O="/api/chat/route";function P(){return(0,i.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:h})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[923,146],()=>t(677));module.exports=o})();